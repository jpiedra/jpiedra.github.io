---
layout: default
title: GiveMeItems! - the Mutator
tags: unrealscript mutator givemeitems
---

<div>
	<div class="page-title">
    	GiveMeItems!</div>
	</div>
	<p class="page-title-2">A mutator and GUI addon for Unreal Tournament. A Work in Progress.</p> 
	</br>
	<p class="page-title-2">The Mutator</p> 
	<p class="page-paragraph">The mutator is the component added to an actual game, and is responsible for overriding default monster properties.</p>
	</br>
	<p class="page-title-2">Declaration and Variables</p> 
	<p class="page-paragraph">The mutator code begins with a definition of what the code itself is. It derives from the super or parent class, Mutator, which itself contains all the required methods, functions, and other information to make a mutator. Hence, GiveMeItems is its own class which derives from Mutator. GiveMeItems is bound to a configuration file, which is called "GiveMeItems" and stores information used in the mutator during runtime.</p>
<div class="col-sm-12"><pre class="pre-pad" ><span class="inner-pre" style="color:#00FF99">
class GiveMeItems expands Mutator config(GiveMeItems);

var() config int destroyTime;
var() config String ItemChoice[24];
var class&#60Inventory&#62 IVar[24];
var int i;
var float Selection;

</span></pre>
		</div>
<p class="page-paragraph">To connect the mutator to its relevant configuration file, the keyword 'config' is used and the name of the file is written after it in parentheses, similar to the way one would pass an object to a function. We can also see the 'config' keyword below, next to an int variable called 'destroyTime', and an array of strings called 'ItemChoice'. Here, the purpose of the keyword config is to indicate that these variables can be found in the configuration file that has been loaded. As later explained in the window component section, an in-game GUI allows the modification of contents in the configuration file to be done with greater ease and validation.</p>
<p class="page-paragraph">These variables, however, all begin with the keyword 'var', a convention in Unrealscript, and are necessary for specific tasks essential to the mutator. 'destroyTime' is an integer variable which represents the amount of time, in seconds, that passes before every item added by GiveMeItems is removed from the level. 'ItemChoice[24]' contains 24 elements in an array of String type objects; these strings each represent the textual name of an object (for example, 'Botpack.healthvial' is an Inventory object from the package 'Botpack', and that entire string represents the text name for the object, which would be stored as an element in the array 'ItemChoice'). </p>
<p class="page-paragraph">'var class&#60Inventory&#62 IVar[24]' is another array. However, its element are of a different type - not String as in the former example, but of class&#60Inventory&#62. The angle brackets are placed around the type name, Inventory; and the keyword 'class' is placed before &#60Inventory&#62 to specify the type for the array's elements. The addition of 'class' is done due to the fact that 'Inventory' is a data type specific to Unrealscript, not a primitive type of languages like C and Java (int, or String). However, defining the type inside a pair of angle brackets is not too different from the way C++ vectors are created (for example, "vector &#60int&#62 intVector;").</p>

<p class="page-paragraph">The remaining two variables are of primitive types 'int' and 'float'. 'int i' is a counter variable, used below to process through all elements of an array; 'float Selection' holds a randomly generated number, used to select a random Inventory object in the array IVar.</p>

</br>
<p class="page-title-2">Initializing with PreBeginPlay()</p>
<div class="col-sm-12"><pre class="pre-pad" ><span class="inner-pre" style="color:#00FF99">
function PreBeginPlay()
{
  log("~GiveMeItems - 6/11/2014~");
  log("Initializing Items to load for Monsters...");

  //see below.
  SetTimer(destroyTime, true);
	
  for (i = 0; i &#60 24; i++){
    IVar[i] = class&#60Inventory&#62(DynamicLoadObject(ItemChoice[i], class'Class'));				
    if (IVar[i] == None){
     log("GiveMeItems: Invalid Class for ItemChoice["$i$"], substituting...");
     IVar[i] = class'unrealshare.bandages';} 
    else {
	IVar[i].default.event = 'GMIMutDeleteMe';}
	    }
}

</span></pre>
		</div>
 

<p class="page-paragraph">PreBeginPlay() is where the important things happen. This method is called whenever the programmer wants something to happen prior to any gameplay happening. This means, during the loading of a map, the players in the game, and any other modifications used in that round - as well as this one - are all calculated and accounted for.</p>
<p class="page-paragraph">Thus, it is important that the creation of the Inventory items we want monsters to drop happens prior to any gameplay, rather than during gameplay. After some log messages are broadcast to Unreal's logging system, the first task that is calculated is indicating how often weapons are removed, through 'SetTimer(destroyTime, true)'.</p>

<div class="col-sm-12"><pre class="pre-pad" ><span class="inner-pre" style="color:#FF0099">
//Below is the declaration of the function SetTimer(), and its arguments... 
native final function SetTimer(
    float inRate, 
    bool inbLoop,
);

</span></pre>
		</div>

	<div class="col-sm-12"><pre class="pre-pad" ><span class="inner-pre" style="color:#00FF99">
//=============================================================================
// GiveMeItems.
//=============================================================================
class GiveMeItems expands Mutator config(GiveMeItems);

var() config int destroyTime;
var() config String ItemChoice[24];
var class&#60Inventory&#62 IVar[24];
var int i;
var float Selection;

function PreBeginPlay()
{
  log("~GiveMeItems - 6/11/2014~");
  log("Initializing Items to load for Monsters...");

  //see below.
  SetTimer(destroyTime, true);
	
  for (i = 0; i &#60 24; i++){
    IVar[i] = class&#60Inventory&#62(DynamicLoadObject(ItemChoice[i], class'Class'));				
    if (IVar[i] == None){
     log("GiveMeItems: Invalid Class for ItemChoice["$i$"], substituting...");
     IVar[i] = class'unrealshare.bandages';} 
    else {
	IVar[i].default.event = 'GMIMutDeleteMe';}
	    }
}


function Timer(){

  local inventory inv;

  foreach allactors(class'inventory', inv){
  if (inv.event == 'GMIMutDeleteMe' && inv.IsInState('pickup')){
	inv.destroy();}
	}
}

function bool CheckReplacement(Actor Other, out byte bSuperRelevant) 
{ 
		
  Selection = Rand(24);
		
  if (Selection &#60 24){
  	if(Other.IsA('ScriptedPawn') && 
	   ScriptedPawn(Other).DropWhenKilled == None){
		ScriptedPawn(Other).DropWhenKilled = IVar[Selection];} 
 				}
  return true; 
            
  }             
} </span></pre>
		</div>
